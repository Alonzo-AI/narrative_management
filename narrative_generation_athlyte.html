<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Athlyte Sports Narrative Management</title>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.0/chart.min.js"></script>
        <style>
            /* Reset and base styles */
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
                font-family: "Arial", sans-serif;
            }

            body {
                background-color: rgb(236, 234, 234);
                color: #333;
                line-height: 1.6;
            }

            /* FSU Colors */
            :root {
                --fsu-garnet: #782f40;
                --fsu-gold: #ceb888;
                --fsu-light: #f8f5f0;
                --fsu-dark: #333;
            }

            /* Header styles */
            header {
                background-color: #73d2e7;
                color: white;
                padding: 1.5rem;
                text-align: center;
                box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            }

            h1 {
                font-size: 2rem;
                margin-bottom: 0.5rem;
            }

            h2 {
                font-size: 1.5rem;
                color: white;
                font-weight: normal;
            }

            /* Main content container */
            .container {
                max-width: 1200px;
                margin: 2rem auto;
                padding: 0 1rem;
            }

            /* Controls area */
            .controls {
                background-color: white;
                border-radius: 8px;
                padding: 2rem;
                margin-bottom: 2rem;
                box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            }

            .form-group {
                margin-bottom: 1.5rem;
            }

            label {
                display: block;
                margin-bottom: 0.5rem;
                font-weight: bold;
                color: var(--fsu-dark);
            }

            select {
                width: 100%;
                padding: 0.75rem;
                border: 1px solid #ddd;
                border-radius: 4px;
                font-size: 1rem;
                margin-bottom: 1rem;
            }

            button {
                background-color: #73d2e7;
                color: white;
                border: none;
                padding: 0.75rem 1.5rem;
                border-radius: 4px;
                font-size: 1rem;
                cursor: pointer;
                transition: background-color 0.3s;
            }

            button:hover {
                background-color: rgb(163, 227, 241);
            }

            button:disabled {
                background-color: #ccc;
                cursor: not-allowed;
            }

            /* Twitter feed styles */
            .tweets-container {
                background-color: white;
                border-radius: 8px;
                padding: 2rem;
                box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
                display: none;
            }

            .tweets-container.active {
                display: block;
            }

            .tweet {
                border: 1px solid #e1e8ed;
                border-radius: 12px;
                padding: 1.5rem;
                margin-bottom: 1.5rem;
                background-color: white;
                transition: transform 0.2s;
            }

            .tweet:hover {
                transform: translateY(-3px);
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            }

            .tweet-header {
                display: flex;
                align-items: center;
                margin-bottom: 0.75rem;
            }

            .avatar {
                width: 48px;
                height: 48px;
                border-radius: 50%;
                margin-right: 0.75rem;
                background-color: var(--fsu-garnet);
                display: flex;
                align-items: center;
                justify-content: center;
                color: white;
                font-weight: bold;
                font-size: 1.25rem;
            }

            .user-info {
                flex: 1;
            }

            .display-name {
                font-weight: bold;
                margin-bottom: 0.25rem;
            }

            .username {
                color: #657786;
                font-size: 0.9rem;
            }

            .tweet-body {
                font-size: 1rem;
                line-height: 1.5;
                margin-bottom: 0.75rem;
                white-space: pre-line;
            }

            .tweet-footer {
                display: flex;
                color: #657786;
                font-size: 0.9rem;
            }

            .tweet-footer span {
                margin-right: 1.5rem;
                display: flex;
                align-items: center;
            }

            .tweet-footer i {
                margin-right: 0.5rem;
            }

            .highlight {
                color: var(--fsu-garnet);
                font-weight: bold;
            }

            .hashtag {
                color: #1da1f2;
            }

            /* Infographic styles */
            .tweet-instruction {
                margin-bottom: 1rem;
                color: #657786;
                font-style: italic;
            }

            .tweet {
                cursor: pointer;
                position: relative;
            }

            .tweet.selected {
                border: 2px solid var(--fsu-garnet);
                background-color: rgba(120, 47, 64, 0.05);
            }

            .tweet.selected:after {
                content: "Selected";
                position: absolute;
                top: 10px;
                right: 10px;
                background-color: var(--fsu-garnet);
                color: white;
                padding: 2px 8px;
                border-radius: 10px;
                font-size: 0.75rem;
            }

            .infographic-container {
                background-color: white;
                border-radius: 8px;
                padding: 2rem;
                margin-top: 2rem;
                box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
                display: none;
            }

            .infographic-container.active {
                display: block;
            }

            .infographic {
                background-color: var(--fsu-garnet);
                color: white;
                border-radius: 8px;
                padding: 2rem;
                position: relative;
                overflow: hidden;
            }

            .infographic-header {
                margin-bottom: 1.5rem;
                position: relative;
                z-index: 2;
            }

            .infographic-title {
                font-size: 1.75rem;
                margin-bottom: 0.5rem;
                font-weight: bold;
                color: var(--fsu-gold);
            }

            .infographic-player {
                font-size: 2.5rem;
                font-weight: bold;
                margin-bottom: 0.5rem;
            }

            .stat-grid {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
                gap: 1.5rem;
                margin-bottom: 1.5rem;
                position: relative;
                z-index: 2;
            }

            .stat-box {
                background-color: rgba(255, 255, 255, 0.15);
                border-radius: 8px;
                padding: 1.25rem;
                text-align: center;
                backdrop-filter: blur(5px);
            }

            .stat-value {
                font-size: 1.5rem;
                font-weight: bold;
                margin-bottom: 0.5rem;
                color: var(--fsu-gold);
            }

            .stat-label {
                font-size: 0.6rem;
                text-transform: uppercase;
                letter-spacing: 1px;
            }

            .infographic-footer {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-top: 1.5rem;
                position: relative;
                z-index: 2;
            }

            .infographic-hashtags {
                font-size: 1.1rem;
            }

            .infographic-logo {
                font-weight: bold;
                font-size: 1.25rem;
                color: var(--fsu-gold);
            }

            .infographic-decoration {
                position: absolute;
                width: 200px;
                height: 200px;
                background-color: rgba(255, 255, 255, 0.05);
                border-radius: 50%;
                z-index: 1;
            }

            .decoration-1 {
                top: -100px;
                right: -50px;
            }

            .decoration-2 {
                bottom: -80px;
                left: -80px;
                width: 250px;
                height: 250px;
            }

            /* Responsive adjustments */
            @media (max-width: 768px) {
                .container {
                    padding: 0 0.5rem;
                }

                .controls,
                .tweets-container,
                .infographic-container {
                    padding: 1.5rem;
                }

                h1 {
                    font-size: 1.75rem;
                }

                h2 {
                    font-size: 1.25rem;
                }

                .stat-grid {
                    grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
                    gap: 1rem;
                }

                .stat-value {
                    font-size: 2rem;
                }

                .infographic-player {
                    font-size: 2rem;
                }
            }
            .chart-container {
                margin: 1.5rem 0;
                background-color: rgba(255, 255, 255, 0.15);
                border-radius: 8px;
                padding: 1rem;
                backdrop-filter: blur(5px);
            }

            canvas {
                width: 100% !important;
                height: auto !important;
                max-height: 300px;
            }

            /* Inline tweet infographic styling */
            .tweet-infographic-container {
                margin: 0.75rem 0 1rem 0;
                border-radius: 8px;
                overflow: hidden;
            }

            .inline-infographic {
                padding: 1rem;
                border-radius: 8px;
                background-color: var(--fsu-garnet);
                color: white;
                font-size: 0.9em;
            }

            .inline-infographic .infographic-player {
                font-size: 1.8rem;
            }

            .inline-infographic .infographic-title {
                font-size: 1.3rem;
            }

            .inline-infographic .player-details {
                font-size: 0.9rem;
            }

            .inline-infographic .stat-grid {
                grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
                gap: 0.75rem;
                margin: 0.75rem 0;
            }

            .inline-infographic .stat-box {
                padding: 0.75rem;
            }

            .inline-infographic .stat-value {
                font-size: 1.8rem;
            }

            .inline-infographic .chart-container {
                height: 200px;
                margin: 0.75rem 0;
            }

            .inline-infographic .infographic-footer {
                margin-top: 0.75rem;
                font-size: 0.9rem;
            }

            /* Make the tweet wider to accommodate the infographic */
            .tweet {
                max-width: 100%;
            }
        </style>
    </head>
    <body>
        <header>
            <h1>Athlyte Sports Narrative Management</h1>
            <h2>Bringing sports stories to life</h2>
        </header>

        <div class="container">
            <div class="controls">
                <div class="form-group">
                    <label for="narrative-select">Select Narrative:</label>
                    <select id="narrative-select">
                        <option value="">-- Select Narrative --</option>
                        <option value="player-focus">Player in Focus</option>
                    </select>
                </div>

                <div
                    class="form-group"
                    id="player-select-container"
                    style="display: none"
                >
                    <label for="player-select">Select Player:</label>
                    <select id="player-select">
                        <option value="">-- Select Player --</option>
                    </select>
                </div>

                <button id="generate-btn" disabled>Generate Stories</button>
            </div>

            <div class="tweets-container" id="tweets-container">
                <h2 style="margin-bottom: 1.5rem; color: #73d2e7">
                    Generated Stories
                </h2>

                <div id="tweets-list"></div>
            </div>

            <div class="infographic-container" id="infographic-container">
                <h2 style="margin-bottom: 1.5rem; color: var(--fsu-garnet)">
                    Infographic
                </h2>
                <div id="infographic-content"></div>
            </div>
        </div>

        <script type="text/javascript">
            // Initialize the application
            document.addEventListener("DOMContentLoaded", function () {
                // DOM elements
                const narrativeSelect =
                    document.getElementById("narrative-select");
                const playerSelectContainer = document.getElementById(
                    "player-select-container",
                );
                const playerSelect = document.getElementById("player-select");
                const generateBtn = document.getElementById("generate-btn");
                const tweetsContainer =
                    document.getElementById("tweets-container");
                const tweetsList = document.getElementById("tweets-list");
                const infographicContainer = document.getElementById(
                    "infographic-container",
                );
                const infographicContent = document.getElementById(
                    "infographic-content",
                );

                // Available players for each narrative
                const players = {
                    "player-focus": ["Trey Benson"],
                };

                // Generated tweets for Trey Benson
                const treyBensonTweets = [
                    "Trey Benson goes OFF! üí• Shatters his personal best with 200 rushing yards, surpassing his previous record of 163! üèÉüí® #GoNoles",
                    "Another dominant performance! Trey Benson now has 6 games with 100+ yards and 2 with 150+ yards after torching Virginia Tech! üî• #FSU",
                    "Benson > VT's entire backfield! Trey Benson exploded for 200 yards, outgaining Virginia Tech's top rusher Kyron Drones (80 yards) by a mile! üöÄ #Noles",
                    "üö® History Made! üö®\nTrey Benson just set the all-time rushing record for any FSU player against Virginia Tech with 200 yards on the ground! üåüüèÜHe surpasses Greg Jones 2002 performance of 120 yards vs. the Hokies. What a performance! üî•#GoNoles | #TreyBenson | #RecordBreaker",
                    "üî• Consistency King! üî•\nTrey Benson just logged his 4th consecutive game with 50+ rushing yards against AAC opponents! üí®üí™Dominating the ground game and keeping the streak alive! üöÄüèÜ#GoNoles | #TreyBenson | #GroundGameStrong",
                    "üöÄ **Trey Benson hits a new gear!** Breaks his career-long rush with an **85-yard** sprint vs. Virginia Tech, smashing his previous best of **55 yards** vs. Pitt earlier this season! üî•üí® #GoNoles #FSU",
                    "üî• **Trey Benson turns on the jets!** His **85-yard** dash vs. Virginia Tech is the **longest rush by any FSU player in the 2023 season!** üöÄüí® #GoNoles #FSU",
                ];

                // Player statistics data for infographics
                const playerStats = {
                    "trey-benson": {
                        // Base stats always included
                        baseStats: {
                            name: "Trey Benson",
                            position: "Running Back",
                            number: "#3",
                            height: "6'1\"",
                            weight: "223 lbs",
                            year: "Junior",
                        },
                        // Stats for specific tweets
                        tweetStats: [
                            // Tweet 0: 200 rushing yards, previous record 163
                            // Tweet 0: 200 rushing yards, previous record 163
                            // Tweet 0: 200 rushing yards, previous record 163
                            {
                                title: "CAREER PROGRESSION",
                                stats: [
                                    {
                                        value: "200",
                                        label: "Rushing Yards Today",
                                    },
                                    {
                                        value: "163",
                                        label: "Previous Best vs Syracuse (Nov 12, 2022)",
                                    },
                                    {
                                        value: "128",
                                        label: "vs Miami (FL) (Nov 5, 2022)",
                                    },
                                    {
                                        value: "111",
                                        label: "vs Georgia Tech (Oct 29, 2022)",
                                    },
                                ],
                                chartType: "line",
                                chartData: {
                                    title: "Rushing Yards Progression",
                                    labels: [
                                        "Aug 27 vs Duquesne",
                                        "Oct 29 vs Georgia Tech",
                                        "Nov 5 vs Miami (FL)",
                                        "Nov 12 vs Syracuse",
                                        "Nov 25 vs Florida",
                                        "Today vs Virginia Tech",
                                    ],
                                    values: [105, 111, 128, 163, 111, 200],
                                    colors: "rgba(206, 184, 136, 0.3)", // Area under the line
                                    borderColors: "rgba(206, 184, 136, 1)", // Line color
                                    showLegend: false,
                                    tension: 0.3, // Curved line for smoother look
                                },
                                hashtags: "#GoNoles #RecordDay",
                            },
                            // Tweet 1: 6 games with 100+ yards, 2 with 150+
                            // Tweet 1: 6 games with 100+ yards, 2 with 150+
                            {
                                title: "RUSHING PERFORMANCE BREAKDOWN",
                                stats: [
                                    {
                                        value: "6",
                                        label: "Games with 100+ Yards",
                                    },
                                    {
                                        value: "2",
                                        label: "Games with 150+ Yards",
                                    },
                                    {
                                        value: "28",
                                        label: "Total Games Played",
                                    },
                                    {
                                        value: "21%",
                                        label: "Games with 100+ Yards %",
                                    },
                                ],
                                chartType: "horizontalBar",
                                chartData: {
                                    title: "Games by Rushing Yard Range",
                                    labels: [
                                        "150+ Yards",
                                        "100-149 Yards",
                                        "50-99 Yards",
                                        "25-49 Yards",
                                        "Under 25 Yards",
                                    ],
                                    values: [2, 4, 10, 5, 7],
                                    colors: [
                                        "rgba(255, 215, 0, 0.8)", // Bright gold for 150+
                                        "rgba(206, 184, 136, 0.8)", // Light gold for 100-149
                                        "rgba(200, 200, 200, 0.6)", // Light gray for 50-99
                                        "rgba(170, 170, 170, 0.6)", // Medium gray for 25-49
                                        "rgba(140, 140, 140, 0.6)", // Dark gray for under 25
                                    ],
                                    borderColors: [
                                        "rgba(255, 215, 0, 1)",
                                        "rgba(206, 184, 136, 1)",
                                        "rgba(220, 220, 220, 1)",
                                        "rgba(190, 190, 190, 1)",
                                        "rgba(160, 160, 160, 1)",
                                    ],
                                    showLegend: true,
                                },
                                hashtags: "#FSU #DominantRB",
                            },
                            // Tweet 2: Benson outgaining VT rushers
                            // Tweet 2: Benson outgaining VT rushers with polar chart
                            // Tweet 2: Benson outgaining VT rushers
                            {
                                title: "RUSHING DOMINANCE VS VIRGINIA TECH",
                                stats: [
                                    {
                                        value: "200",
                                        label: "Trey Benson Rushing Yards",
                                    },
                                    {
                                        value: "80",
                                        label: "K. Drones (VT) Rushing Yards",
                                    },
                                    {
                                        value: "209",
                                        label: "VT Total Team Rushing Yards",
                                    },
                                    {
                                        value: "250%",
                                        label: "Benson vs VT Top Rusher %",
                                    },
                                ],
                                chartType: "horizontalBar",
                                chartData: {
                                    title: "Rushing Yards Comparison",
                                    labels: [
                                        "Trey Benson",
                                        "K. Drones",
                                        "M. Thomas",
                                        "B. Duke",
                                        "B. Tuten",
                                        "C. Black",
                                    ],
                                    values: [200, 80, 58, 39, 29, 3],
                                    colors: [
                                        "rgba(206, 184, 136, 0.8)", // Gold for Benson
                                        "rgba(200, 200, 200, 0.8)", // Light gray for VT players
                                        "rgba(200, 200, 200, 0.8)",
                                        "rgba(200, 200, 200, 0.8)",
                                        "rgba(200, 200, 200, 0.8)",
                                        "rgba(200, 200, 200, 0.8)",
                                    ],
                                    borderColors: [
                                        "rgba(206, 184, 136, 1)",
                                        "rgba(220, 220, 220, 1)",
                                        "rgba(220, 220, 220, 1)",
                                        "rgba(220, 220, 220, 1)",
                                        "rgba(220, 220, 220, 1)",
                                        "rgba(220, 220, 220, 1)",
                                    ],
                                    showLegend: false,
                                },
                                hashtags: "#DominantRusher #GoNoles",
                            },
                            // Find the tweetStats array in the playerStats object

                            {
                                title: "FSU ALL-TIME RUSHING RECORD VS VIRGINIA TECH",
                                stats: [
                                    {
                                        value: "200",
                                        label: "Trey Benson (2023)",
                                    },
                                    {
                                        value: "120",
                                        label: "Greg Jones (2002)",
                                    },
                                    {
                                        value: "119",
                                        label: "Dexter Carter (1988)",
                                    },
                                    {
                                        value: "66%",
                                        label: "Margin Over Previous Record",
                                    },
                                ],
                                chartType: "horizontalBar",
                                chartData: {
                                    title: "Top FSU Rushers vs Virginia Tech",
                                    labels: [
                                        "Trey Benson (2023)",
                                        "Greg Jones (2002)",
                                        "Dexter Carter (1988)",
                                        "Amp Lee (1991)",
                                        "Sammie Smith (1988)",
                                        "Cam Akers (2018)",
                                    ],
                                    values: [200, 120, 119, 107, 87, 82],
                                    colors: [
                                        "rgba(255, 215, 0, 0.8)", // Bright gold for 150+
                                        "rgba(206, 184, 136, 0.8)", // Light gold for 100-149
                                        "rgba(200, 200, 200, 0.6)", // Light gray for 50-99
                                        "rgba(170, 170, 170, 0.6)", // Medium gray for 25-49
                                        "rgba(140, 140, 140, 0.6)", // Dark gray for under 25
                                    ],
                                    borderColors: [
                                        "rgba(255, 215, 0, 1)",
                                        "rgba(206, 184, 136, 1)",
                                        "rgba(220, 220, 220, 1)",
                                        "rgba(190, 190, 190, 1)",
                                        "rgba(160, 160, 160, 1)",
                                    ],
                                    showLegend: false,
                                },
                                hashtags:
                                    "#GoNoles #RecordBreaker #HistoryMade",
                            },
                            // remaining tweet stats
                        ],
                    },
                };

                // Event handlers
                narrativeSelect.addEventListener("change", function () {
                    const selectedNarrative = this.value;

                    // Reset player select
                    playerSelect.innerHTML =
                        '<option value="">-- Select Player --</option>';

                    if (selectedNarrative) {
                        // Show player select
                        playerSelectContainer.style.display = "block";

                        // Populate player options
                        const availablePlayers =
                            players[selectedNarrative] || [];
                        availablePlayers.forEach((player) => {
                            const option = document.createElement("option");
                            option.value = player
                                .toLowerCase()
                                .replace(/\s+/g, "-");
                            option.textContent = player;
                            playerSelect.appendChild(option);
                        });
                    } else {
                        // Hide player select
                        playerSelectContainer.style.display = "none";
                    }

                    // Disable generate button
                    generateBtn.disabled = true;

                    // Hide tweets and infographic
                    tweetsContainer.classList.remove("active");
                    infographicContainer.classList.remove("active");
                });

                playerSelect.addEventListener("change", function () {
                    // Enable/disable generate button based on selection
                    generateBtn.disabled = !this.value;
                });

                // Function to create a tweet element
                // Function to create a tweet element

                // Function to generate infographic based on selected tweet

                // Format tweet text to highlight hashtags
                function formatTweetText(text) {
                    // Bold text between **
                    text = text.replace(
                        /\*\*(.*?)\*\*/g,
                        "<strong>$1</strong>",
                    );

                    // Highlight hashtags
                    text = text.replace(
                        /#(\w+)/g,
                        '<span class="hashtag">#$1</span>',
                    );

                    return text;
                }

                // Format time for Twitter-like display
                function formatTwitterTime(date) {
                    const now = new Date();
                    const diffMs = now - date;
                    const diffMins = Math.floor(diffMs / 60000);

                    if (diffMins < 1) {
                        return "just now";
                    } else if (diffMins < 60) {
                        return `${diffMins}m`;
                    } else {
                        const diffHours = Math.floor(diffMins / 60);
                        if (diffHours < 24) {
                            return `${diffHours}h`;
                        } else {
                            const month = date.toLocaleString("default", {
                                month: "short",
                            });
                            const day = date.getDate();
                            return `${month} ${day}`;
                        }
                    }
                }
                // Add this function to generate inline infographics
                function generateInlineInfographic(
                    player,
                    tweetIndex,
                    container,
                ) {
                    // Skip if no valid data for this tweet
                    const playerData = playerStats[player];
                    if (!playerData || !playerData.tweetStats[tweetIndex])
                        return;

                    const tweetData = playerData.tweetStats[tweetIndex];

                    // Create a simplified version of the infographic
                    const infographic = document.createElement("div");
                    infographic.className = "infographic inline";

                    // Add chart if available
                    if (tweetData.chartType) {
                        const chartContainer = document.createElement("div");
                        chartContainer.className = "chart-container";

                        const canvas = document.createElement("canvas");
                        canvas.id = `inline-chart-${tweetIndex}`;
                        canvas.width = 400;
                        canvas.height = 200;

                        chartContainer.appendChild(canvas);
                        infographic.appendChild(chartContainer);

                        // Create chart once added to DOM
                        container.appendChild(infographic);
                        setTimeout(
                            () =>
                                createChart(
                                    canvas.id,
                                    tweetData.chartType,
                                    tweetData.chartData,
                                ),
                            0,
                        );
                    }
                }
                // Format tweet text to highlight hashtags
                function formatTweetText(text) {
                    // Bold text between **
                    text = text.replace(
                        /\*\*(.*?)\*\*/g,
                        "<strong>$1</strong>",
                    );

                    // Highlight hashtags
                    text = text.replace(
                        /#(\w+)/g,
                        '<span class="hashtag">#$1</span>',
                    );

                    return text;
                }

                // Function to generate infographic based on selected tweet
                function generateInfographic(player, tweetIndex) {
                    // Clear previous infographic
                    infographicContent.innerHTML = "";

                    // Get player data
                    const playerData = playerStats[player];
                    if (!playerData) return;

                    // Get tweet-specific stats
                    const tweetData = playerData.tweetStats[tweetIndex];
                    const baseStats = playerData.baseStats;

                    // Create infographic element
                    const infographic = document.createElement("div");
                    infographic.className = "infographic";

                    // Create header
                    const header = document.createElement("div");
                    header.className = "infographic-header";
                    header.innerHTML = `
                    <div class="infographic-title">${tweetData.title}</div>
                    <div class="infographic-player">${baseStats.name}</div>
                    <div>${baseStats.position} | ${baseStats.number} | ${baseStats.height} | ${baseStats.weight} | ${baseStats.year}</div>
                `;

                    // Create stat grid
                    const statGrid = document.createElement("div");
                    statGrid.className = "stat-grid";

                    // Add stats
                    tweetData.stats.forEach((stat) => {
                        const statBox = document.createElement("div");
                        statBox.className = "stat-box";
                        statBox.innerHTML = `
                        <div class="stat-value">${stat.value}</div>
                        <div class="stat-label">${stat.label}</div>
                    `;
                        statGrid.appendChild(statBox);
                    });

                    // Create footer
                    const footer = document.createElement("div");
                    footer.className = "infographic-footer";
                    footer.innerHTML = `
                    <div class="infographic-hashtags">${tweetData.hashtags}</div>
                    <div class="infographic-logo">FSU FOOTBALL</div>
                `;

                    // Add decorative elements
                    const decoration1 = document.createElement("div");
                    decoration1.className =
                        "infographic-decoration decoration-1";

                    const decoration2 = document.createElement("div");
                    decoration2.className =
                        "infographic-decoration decoration-2";

                    // Assemble infographic
                    infographic.appendChild(header);
                    infographic.appendChild(statGrid);
                    // Add this code:
                    // Create chart container
                    if (tweetData.chartType) {
                        const chartContainer = document.createElement("div");
                        chartContainer.className = "chart-container";

                        const canvas = document.createElement("canvas");
                        canvas.id = `chart-${tweetIndex}`;
                        canvas.width = 400;
                        canvas.height = 200;

                        chartContainer.appendChild(canvas);
                        infographic.appendChild(chartContainer);

                        // Create chart after the infographic is added to DOM
                        setTimeout(
                            () =>
                                createChart(
                                    canvas.id,
                                    tweetData.chartType,
                                    tweetData.chartData,
                                ),
                            0,
                        );
                    }

                    infographic.appendChild(footer);
                    infographic.appendChild(decoration1);
                    infographic.appendChild(decoration2);

                    // Add to container
                    infographicContent.appendChild(infographic);
                }
                // Function to create a tweet element
                // Function to create a tweet element
                function createTweetElement(tweetText, index) {
                    const tweet = document.createElement("div");
                    tweet.className = "tweet";
                    tweet.dataset.index = index;

                    const now = new Date();
                    const minutesAgo = index * 5; // Each tweet is 5 minutes apart
                    now.setMinutes(now.getMinutes() - minutesAgo);

                    // Format time string
                    const timeString = formatTwitterTime(now);

                    // Format tweet text with hashtags
                    const formattedText = formatTweetText(tweetText);

                    // Create tweet content
                    tweet.innerHTML = `
                        <div class="tweet-header">
                            <div class="avatar">F</div>
                            <div class="user-info">
                                <div class="display-name">FSU Football</div>
                                <div class="username">@FSUFootball</div>
                            </div>
                        </div>
                        <div class="tweet-body">${formattedText}</div>
                    `;

                    // Add full infographic to tweet
                    const playerSelected =
                        document.getElementById("player-select").value;
                    if (
                        playerSelected &&
                        playerStats[playerSelected] &&
                        playerStats[playerSelected].tweetStats[index]
                    ) {
                        // Create container for the inline infographic
                        const inlineInfographicContainer =
                            document.createElement("div");
                        inlineInfographicContainer.className =
                            "tweet-infographic-container";

                        // Add to tweet
                        tweet.appendChild(inlineInfographicContainer);

                        // Generate the full infographic
                        createInlineTweetInfographic(
                            playerSelected,
                            index,
                            inlineInfographicContainer,
                        );
                    }

                    // Add tweet footer
                    const tweetFooter = document.createElement("div");
                    tweetFooter.className = "tweet-footer";
                    tweetFooter.innerHTML = `
                        <span><i>‚ô°</i> ${Math.floor(Math.random() * 500) + 100}</span>
                        <span><i>‚Ü∫</i> ${Math.floor(Math.random() * 200) + 50}</span>
                        <span><i>‚öë</i> ${timeString}</span>
                    `;
                    tweet.appendChild(tweetFooter);

                    return tweet;
                }

                // Function to create a full infographic inside a tweet
                function createInlineTweetInfographic(
                    player,
                    tweetIndex,
                    container,
                ) {
                    // Get player data
                    const playerData = playerStats[player];
                    if (!playerData) return;

                    // Get tweet-specific stats
                    const tweetData = playerData.tweetStats[tweetIndex];
                    const baseStats = playerData.baseStats;

                    if (!tweetData) return;

                    // Create infographic element
                    const infographic = document.createElement("div");
                    infographic.className = "infographic inline-infographic";

                    // Create header
                    const header = document.createElement("div");
                    header.className = "infographic-header";
                    header.innerHTML = `
                        <div class="infographic-title">${tweetData.title}</div>
                        <div class="infographic-player">${baseStats.name}</div>
                        <div class="player-details">${baseStats.position} | ${baseStats.number} | ${baseStats.height} | ${baseStats.weight}</div>
                    `;

                    // Create stat grid
                    const statGrid = document.createElement("div");
                    statGrid.className = "stat-grid";

                    // Add stats
                    tweetData.stats.forEach((stat) => {
                        const statBox = document.createElement("div");
                        statBox.className = "stat-box";
                        statBox.innerHTML = `
                            <div class="stat-value">${stat.value}</div>
                            <div class="stat-label">${stat.label}</div>
                        `;
                        statGrid.appendChild(statBox);
                    });

                    // Add chart if available
                    if (tweetData.chartType) {
                        const chartContainer = document.createElement("div");
                        chartContainer.className = "chart-container";

                        const canvas = document.createElement("canvas");
                        canvas.id = `tweet-chart-${tweetIndex}`;
                        chartContainer.appendChild(canvas);

                        // Add chart container to infographic
                        infographic.appendChild(header);
                        infographic.appendChild(statGrid);
                        infographic.appendChild(chartContainer);

                        // Add footer with hashtags
                        const footer = document.createElement("div");
                        footer.className = "infographic-footer";
                        footer.innerHTML = `
                            <div class="infographic-hashtags">${tweetData.hashtags}</div>
                            <div class="infographic-logo">FSU FOOTBALL</div>
                        `;

                        infographic.appendChild(footer);

                        // Add decorative elements
                        const decoration1 = document.createElement("div");
                        decoration1.className =
                            "infographic-decoration decoration-1";

                        const decoration2 = document.createElement("div");
                        decoration2.className =
                            "infographic-decoration decoration-2";

                        infographic.appendChild(decoration1);
                        infographic.appendChild(decoration2);

                        // Add to container
                        container.appendChild(infographic);

                        // Create chart after added to DOM
                        setTimeout(
                            () =>
                                createChart(
                                    canvas.id,
                                    tweetData.chartType,
                                    tweetData.chartData,
                                ),
                            10,
                        );
                    } else {
                        // No chart, just add the stat grid
                        infographic.appendChild(header);
                        infographic.appendChild(statGrid);
                        container.appendChild(infographic);
                    }
                }
                // Event handlers for the application
                narrativeSelect.addEventListener("change", function () {
                    const selectedNarrative = this.value;

                    // Reset player select
                    playerSelect.innerHTML =
                        '<option value="">-- Select Player --</option>';

                    if (selectedNarrative) {
                        // Show player select
                        playerSelectContainer.style.display = "block";

                        // Populate player options
                        const availablePlayers =
                            players[selectedNarrative] || [];
                        availablePlayers.forEach((player) => {
                            const option = document.createElement("option");
                            option.value = player
                                .toLowerCase()
                                .replace(/\s+/g, "-");
                            option.textContent = player;
                            playerSelect.appendChild(option);
                        });
                    } else {
                        // Hide player select
                        playerSelectContainer.style.display = "none";
                    }

                    // Disable generate button
                    generateBtn.disabled = true;

                    // Hide tweets and infographic
                    tweetsContainer.classList.remove("active");
                    infographicContainer.classList.remove("active");
                });

                playerSelect.addEventListener("change", function () {
                    // Enable/disable generate button based on selection
                    generateBtn.disabled = !this.value;
                });

                generateBtn.addEventListener("click", function () {
                    const selectedNarrative = narrativeSelect.value;
                    const selectedPlayer = playerSelect.value;

                    if (selectedNarrative && selectedPlayer) {
                        // Clear previous tweets

                        tweetsList.innerHTML = "";

                        // Generate tweets based on selection
                        let tweets = [];

                        if (selectedPlayer === "trey-benson") {
                            tweets = treyBensonTweets;
                        }

                        // Create tweet elements
                        tweets.forEach((tweetText, index) => {
                            const tweetEl = createTweetElement(
                                tweetText,
                                index,
                            );

                            // Add click event to generate infographic
                            const tweetContainer =
                                document.createElement("div");
                            tweetContainer.className = "tweet-with-infographic";

                            // Add the tweet element
                            tweetContainer.appendChild(tweetEl);

                            // Create a div for the inline infographic
                            // const inlineInfographic =
                            //     document.createElement("div");
                            // inlineInfographic.className = "inline-infographic";

                            // // Generate infographic content
                            // generateInlineInfographic(
                            //     selectedPlayer,
                            //     index,
                            //     inlineInfographic,
                            // );

                            // // Add the infographic to the container
                            // tweetContainer.appendChild(inlineInfographic);

                            // Add the container to the tweets list
                            tweetsList.appendChild(tweetContainer);
                        });
                        tweetsContainer.style.display = "block";
                    }
                });

                function createChart(canvasId, chartType, chartData) {
                    const ctx = document
                        .getElementById(canvasId)
                        .getContext("2d");

                    // Dataset configuration
                    const datasets = [];

                    // Add main dataset
                    const mainDataset = {
                        label: chartData.title,
                        data: chartData.values,
                        borderWidth: 2,
                    };

                    // Add chart-type specific settings
                    if (chartType === "line") {
                        mainDataset.fill = true;
                        mainDataset.backgroundColor = chartData.colors;
                        mainDataset.borderColor = chartData.borderColors;
                        mainDataset.pointBackgroundColor =
                            chartData.borderColors;
                        mainDataset.pointRadius = 5;
                        mainDataset.pointHoverRadius = 7;
                        mainDataset.tension = chartData.tension || 0;
                    } else if (
                        chartType === "pie" ||
                        chartType === "doughnut" ||
                        chartType === "polarArea"
                    ) {
                        mainDataset.backgroundColor =
                            chartData.colors ||
                            Array(chartData.values.length).fill(
                                "rgba(206, 184, 136, 0.7)",
                            );
                        mainDataset.borderColor =
                            chartData.borderColors ||
                            Array(chartData.values.length).fill(
                                "rgba(206, 184, 136, 1)",
                            );
                        mainDataset.hoverOffset = 4;
                    } else {
                        mainDataset.backgroundColor =
                            chartData.colors ||
                            Array(chartData.values.length).fill(
                                "rgba(206, 184, 136, 0.7)",
                            );
                        mainDataset.borderColor =
                            chartData.borderColors ||
                            Array(chartData.values.length).fill(
                                "rgba(206, 184, 136, 1)",
                            );
                    }

                    datasets.push(mainDataset);

                    // Add threshold line if specified
                    if (
                        chartData.thresholdLine &&
                        (chartType === "bar" ||
                            chartType === "line" ||
                            chartType === "horizontalBar")
                    ) {
                        datasets.push({
                            label: "100+ Yard Threshold",
                            data: Array(chartData.labels.length).fill(
                                chartData.thresholdLine,
                            ),
                            type: "line",
                            borderColor: "rgba(255, 255, 255, 0.7)",
                            borderWidth: 2,
                            borderDash: [6, 6],
                            pointRadius: 0,
                            fill: false,
                            order: 1, // Ensure it's drawn on top
                        });
                    }

                    // Chart.js configuration
                    let config = {
                        type: chartType === "horizontalBar" ? "bar" : chartType, // Convert horizontalBar to bar with options
                        data: {
                            labels: chartData.labels,
                            datasets: datasets,
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    display:
                                        chartData.showLegend ||
                                        (chartData.thresholdLine
                                            ? true
                                            : false),
                                    position: "top",
                                    labels: {
                                        color: "white",
                                        font: {
                                            size: 12,
                                        },
                                    },
                                },
                                tooltip: {
                                    backgroundColor: "rgba(0, 0, 0, 0.7)",
                                    titleFont: {
                                        size: 14,
                                    },
                                    bodyFont: {
                                        size: 13,
                                    },
                                    callbacks: {
                                        label: function (context) {
                                            if (
                                                context.dataset.label ===
                                                "100+ Yard Threshold"
                                            ) {
                                                return "100+ Yard Benchmark";
                                            }
                                            if (
                                                chartType === "pie" ||
                                                chartType === "doughnut" ||
                                                chartType === "polarArea"
                                            ) {
                                                return ` ${context.label}: ${context.raw} yards`;
                                            }
                                            return `${context.raw} yards`;
                                        },
                                    },
                                },
                            },
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    ticks: {
                                        color: "white",
                                        font: {
                                            size: 12,
                                        },
                                    },
                                    grid: {
                                        color: "rgba(255, 255, 255, 0.1)",
                                    },
                                    title: {
                                        display: true,
                                        text:
                                            chartType === "horizontalBar"
                                                ? ""
                                                : "Rushing Yards",
                                        color: "white",
                                        font: {
                                            size: 14,
                                        },
                                    },
                                },
                                x: {
                                    ticks: {
                                        color: "white",
                                        maxRotation: 45,
                                        minRotation: 45,
                                        font: {
                                            size: 12,
                                        },
                                    },
                                    grid: {
                                        color: "rgba(255, 255, 255, 0.1)",
                                    },
                                    title: {
                                        display: true,
                                        text:
                                            chartType === "horizontalBar"
                                                ? "Rushing Yards"
                                                : "",
                                        color: "white",
                                        font: {
                                            size: 14,
                                        },
                                    },
                                },
                            },
                            layout: {
                                padding: {
                                    top: 10,
                                    right: 20,
                                    bottom: 25,
                                    left: 20,
                                },
                            },
                        },
                    };

                    // Special configuration for horizontal bar chart
                    if (chartType === "horizontalBar") {
                        config.options.indexAxis = "y"; // Make the bars horizontal
                    }

                    // Special configuration for pie/doughnut/polar charts
                    if (
                        chartType === "pie" ||
                        chartType === "doughnut" ||
                        chartType === "polarArea"
                    ) {
                        // Remove scales for pie/doughnut/polar charts
                        delete config.options.scales;
                    }

                    // Create chart
                    new Chart(ctx, config);
                }
            });
        </script>
    </body>
</html>
